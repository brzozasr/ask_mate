{% extends 'pattern.html' %}

{% block title %}Questions View{% endblock %}
{% set question = question[0] %}
{% set q_id = question[0] %}
{% set q_date_sub = 1 %}
{% set q_view = 2 %}
{% set q_vote = 3 %}
{% set q_title = 4 %}
{% set q_question = 5 %}
{% set q_image = 6 %}
{% set q_date = question[q_date_sub]|string -%}
{% set a_id = 0 %}
{% set a_date_sub = 1 %}
{% set a_vote = 2 %}
{% set a_answer = 4 %}
{% set a_image = 5 %}
{% block content %}
    <h2 class="title">Question View</h2>
    <p><a class="btn_green" href="{{ url_for('question_list') }}">&lt;&lt; Back to questions</a></p>
        <div class="question">
            <p><small>Posted date: {{ q_date[:19] }}, Viewed: {{ question[q_view] }}</small></p>
            <p><strong>{{ question[q_title] }}</strong><br>
            {{ question[q_question] }}</p>
            {% if question[q_image] != None -%}
            <img class="pic" src="{{ question[q_image] }}" alt="Add image">
            {%- endif -%}
            <div class="vote_outer">
                <div>
                    <a class="vote" href="{{ url_for('vote', element='question', question_id=q_id, value=1) }}">+</a>&nbsp;<a class="vote" href="{{ url_for('vote', element='question', question_id=q_id, value=2) }}">-</a>
                </div>
                <div>&nbsp;&nbsp;<small>Vote: {{ question[q_vote] }}</small></div>
                <div class="separate"><a class="add" style="margin-right: 50px" href="{{ url_for('new_answer', question_id=q_id) }}">+ Add answer</a>
                {% if question[q_image] == None -%}
                <a class="add" href="{{ url_for('upload_file.upload_img_question', question_id=q_id) }}">+ Add image</a>
                {%- endif %}
                <a class="edit" href="{{ url_for('edit_question', question_id=q_id) }}">&plusmn; Edit question</a>
                <a class="del" href="{{ url_for('delete_question', question_id=q_id) }}" onclick="return confirm('Do you want to delete question with ID: {{ q_id }}?');">- Delete question</a>
                </div>
            </div>
        </div>
        {% for a_line in answer -%}
        {% set a_date = a_line[a_date_sub]|string -%}
        <div class="answer">
            <p><small>Posted date: {{ a_date[:19] }}</small></p>
            <p>{{ a_line[a_answer] }}</p>
            {% if a_line[a_image] != None -%}
            <img class="pic" src="{{ a_line[a_image] }}" alt="Add image">
            {%- endif -%}
            <div class="vote_outer">
                <div>
                    <a class="vote" href="{{ url_for('vote', element='answer', question_id=q_id, value=1, answer_id=a_line[a_id]) }}">+</a>&nbsp;<a class="vote" href="{{ url_for('vote', element='answer', question_id=q_id, value=2, answer_id=a_line[a_id]) }}">-</a>
                </div>
                <div>&nbsp;&nbsp;<small>Vote: {{ a_line[a_vote] }}</small></div>
                <div class="separate">
                {% if a_line[a_image] == None -%}
                <a class="add" href="{{ url_for('upload_file.upload_img_answer', answer_id=a_line[a_id], question_id=q_id) }}">+ Add image</a>
                {%- endif %}
                <a class="del" href="{{ url_for('delete_answer', answer_id=a_line[a_id]) }}" onclick="return confirm('Do you want to delete answer with ID: {{ a_line[a_id] }}?');">- Delete answer</a>
                </div>
            </div>
        </div>
        {%- endfor %}
{% endblock %}